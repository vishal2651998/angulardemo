<div id="header">
    <app-header [pageData]="headerData"></app-header>
</div>
<div *ngIf="loading">
    <div class="loading-small-screen-scroll" align="center">
        <img src="assets/images/landing-page/loading-more.svg" alt="Loader" />
    </div>
</div>
<div *ngIf="lazy" style="left:50%" class="cust-loader esc-loader lazy-loader cust-lazy-loader part-list-lazy-loader"></div>
<div *ngIf="!loading" class="d-flex">
    <div class="left-section">
        <div class="first-left-width">
            <nav id="nav-sidebar">
                <app-sidebar [pageData]="sidebarActiveClass" *ngIf="!user || !user.data.shopId || !shopFacility" accessModule="headquarters"
                    (SidebarComponentRef)="sidebarRef = $event" (menuNav)="menuNav($event)"></app-sidebar>
                <app-sidebar *ngIf="user && user.data.shopId && shopFacility" [pageData]="sidebarActiveClass" accessModule="facility-layout"
                    (SidebarComponentRef)="sidebarRef = $event" (menuNav)="menuNav($event)"></app-sidebar>
            </nav>
        </div>
    </div>
    <div class="right-section">
        <div class="prob-index system-setting">
            <div class="container-fluid">
                <div class="center-middle-width-container">
                    <div class="center-middle-width padding-common padding-common-hq">
                        <div class="hq-head d-flex">
                            <div>
                                <div class="hq-head-row-0" >
                                    <span class="hq-head-breadcrumb-text cursor"
                                        (click)="back('Headquarters')">Headquarters</span>
                                    <img class="hq-head-breadcrumb-img" src="assets/images/hq/hq-bc.png" alt="" />
                                    <span class="hq-head-breadcrumb-text cursor" (click)="back('step1')">Shops</span>
                                </div>
                                <div class="hq-head-row-1">
                                    <img class="hq-head-img" src="assets/images/hq/shop-black.png" alt="" />
                                    <span class="hq-head-text">All Shops</span>
                                </div>
                            </div>
                            <div class="ml-auto d-flex align-items-center">
                                <div (click)="openAddShopModal()" class="m-0 add-action-btn cursor">
                                    <img src="assets/images/hq/add-icon.png">
                                    <span>New Shop</span>
                                </div>
                                <div class="m-0 border-0 add-action-btn cursor">
                                    <img src="assets/images/export-green-icon.png">
                                    <span>Template</span>
                                </div>
                                <div class="m-0 pl-0 border-0 add-action-btn cursor">
                                    <img src="assets/images/common/cdownload-icon.png">
                                    <span>Download Shops</span>
                                </div>
                                <div class="m-0 pl-0 border-0 add-action-btn cursor">
                                    <img src="assets/images/hq/hq-media-green-upload-icon.png">
                                    <span>Upload Shops</span>
                                </div>
                                <div class="bg-light rounded rounded-4 d-flex">
                                    <div (click)="changeView()" *ngIf="viewType !== 'MAP'"
                                        class="p-2 border-right border-gray cursor">
                                        <img src="assets/images/hq/location-primary.png">
                                    </div>
                                    <div (click)="changeView()" *ngIf="viewType == 'MAP'"
                                        class="p-2 border-right border-gray cursor">
                                        <img src="assets/images/hq/location-active.png">
                                    </div>
                                    <div (click)="changeView()" *ngIf="viewType !== 'LIST'" class="p-2 cursor">
                                        <img src="assets/images/hq/list-primary.png">
                                    </div>
                                    <div (click)="changeView()" class="p-2 cursor">
                                        <img *ngIf="viewType == 'LIST'" src="assets/images/hq/list-active.png">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="rt-table position-relative">
                            <div class="position-absolute w-100">
                                <div class="prob-list-cont">
                                    <div class="documents-grid-row documents-grid-row-new">
                                        <!-- HEAD QUATERS ROUTES -->
                                        <div id="matrixTable"
                                            class="gts-mat-table matrix-table parts-mat-table parts-mat-table-fs"
                                            *ngIf="viewType == 'LIST'">
                                            <p-table  #table [columns]="shopListColumns" [scrollable]="true"
                                                [totalRecords]="shopList.length" id="file-datatable"
                                                class="file-datatable thread-list-table shop-list-table ro-list" [value]="shopList" (onLazyLoad)="lazyLoad($event)" [lazy]="true"
                                                [scrollHeight]="'calc(100vh - '+tableRemoveHeight+'px)'">
                                                <ng-template pTemplate="colgroup" let-columns>
                                                    <colgroup>
                                                      <col *ngFor="let col of columns">
                                                    </colgroup>
                                                  </ng-template>
                                                <ng-template pTemplate="header" let-columns>
                                                    <tr>
                                                        <th [pSortableColumn]="col.sortName" *ngFor="let col of columns"
                                                            class="{{col.columnpclass}}">
                                                            {{col.header}}
                                                            <ng-container *ngIf="col.sortName">
                                                                <p-sortIcon [field]="col.sortName"></p-sortIcon>
                                                                <p-columnFilter type="text" [field]="col.sortName" display="menu"></p-columnFilter>
                                                            </ng-container>
                                                        </th>
                                                    </tr>
                                                </ng-template>
                                                <ng-template pTemplate="body" let-shopList let-i="rowIndex">
                                                    <tr class="cursor"
                                                        id="{{shopList.storeNo}}">
                                                        <!-- <td (click)="viewShopEmmiter(shopList)"  class=" w1 shop-thl-col-1 col-sticky" >
                                                            
                                                                <div class=""><span title="{{shopList?.parentName}}"
                                                                        class="overflow-text-table">{{shopList?.parentName}}</span></div>
                                                            
                                                        </td> -->
                                                        <td (click)="viewShopEmmiter(shopList)"  class="w1 shop-thl-col-2 col-sticky">
                                                           
                                                                <div class=""><span title="{{shopList?.id}}"
                                                                        class="overflow-text-table">{{shopList?.id}}</span>
                                                                </div>
                                                           
                                                        </td>
                                                        <td (click)="viewShopEmmiter(shopList)"  class="w3 shop-thl-col-3">
                                                            
                                                                <div class=""><span title="{{shopList?.name}}"
                                                                        class="overflow-text-table">{{shopList?.name}}</span>
                                                                </div>
                                                            
                                                        </td>
                                                        <td (click)="viewShopEmmiter(shopList)"  class="w4 shop-thl-col-4">
                                                            
                                                                <div class="">
                                                                    <span title="{{shopList?.city}}, {{shopList?.state}}" class="overflow-text-table">
                                                                        <span *ngIf="shopList?.city">{{shopList?.city.trim()}}</span>
                                                                        <ng-container
                                                                            *ngIf="shopList.city && shopList.state && shopList.city.trim() !== '' && shopList.state.trim() !== ''">, 
                                                                        </ng-container>
                                                                        {{shopList?.state}}
                                                                    </span>
                                                                </div>
                                                            
                                                        </td>
                                                        <td (click)="viewShopEmmiter(shopList)"  class="w5 shop-thl-col-5">
                                                            
                                                                <div class=""><span title="{{shopList?.shopTypeName}}"
                                                                        class="overflow-text-table">{{shopList?.shopTypeName}}</span>
                                                                </div>
                                                            
                                                        </td>
                                                        <td (click)="viewShopEmmiter(shopList)"  class="w5 shop-thl-col-5">
                                                            
                                                                <div class=""><span title="{{shopList?.dealerCode}}"
                                                                        class="overflow-text-table">{{shopList?.dealerCode}}</span>
                                                                </div>
                                                            
                                                        </td>
                                                        <td (click)="viewShopEmmiter(shopList,'user')"  class="w3 shop-thl-col-3">
                                                            
                                                                <div class="">
                                                                    <span *ngIf="shopList?.usersCount !== 0" class="overflow-text-table txt-link" title="{{shopList?.usersCount}}">{{shopList?.usersCount}}</span>
                                                                    <span *ngIf="shopList?.usersCount == 0" class="overflow-text-table"> - </span>
                                                                </div>
                                                            
                                                        </td>
                                                        <td (click)="viewShopEmmiter(shopList)"  class="w5 shop-thl-col-5">
                                                            
                                                                <div class=""><span title="{{shopList?.levelOneName}}"
                                                                        class="overflow-text-table">{{shopList?.levelOneName}}</span>
                                                                </div>
                                                            
                                                        </td>
                                                        <td (click)="viewShopEmmiter(shopList)"  class="w5 shop-thl-col-5">
                                                            
                                                                <div class=""><span title="{{shopList?.levelTwoName}}"
                                                                        class="overflow-text-table">{{shopList?.levelTwoName}}</span>
                                                                </div>
                                                            
                                                        </td>
                                                        <td (click)="viewShopEmmiter(shopList)"  class="w5 shop-thl-col-5">
                                                            <div class=""><span title="{{shopList?.levelThreeName}}"
                                                                        class="overflow-text-table">{{shopList?.levelThreeName}}</span></div>
                                                               
                                                                   
                                                                </td>
                                                                <td class="w10 shop-thl-col-10 col-sticky">
                                                                    <div id="more" class="more-icon" #menuTrigger="matMenuTrigger" [matMenuTriggerFor]="more" (click)="$event.stopPropagation();">                                    
                                                                        <img src="assets/images/more-icon.svg" alt="Action" onload="SVGInject(this)" />
                                                                    </div>
                                                                    <mat-toolbar color="primary">
                                                                        <mat-menu #more="matMenu" class="list-menu-content active" backdropClass="ptabletmenu">
                                                                            <div class="part-menu">
                                                                                <ul class="more-actions">
                                                                                    <li class="cursor active" (click)="menuTrigger.closeMenu();viewShopEmmiter(shopList)"><img src="assets/images/view.png" alt="View">&nbsp;&nbsp;View</li>
                                                                                    <li class="cursor active" (click)="menuTrigger.closeMenu();editShop(shopList)"><img src="assets/images/edit.png" alt="Edit">&nbsp;&nbsp;Edit</li>
                                                                                    <!--li class="cursor active" (click)="menuTrigger.closeMenu();"><img src="assets/images/delete.png" alt="Delete">&nbsp;&nbsp;Delete</li-->                                                                                       
                                                                                </ul>
                                                                            </div>
                                                                        </mat-menu>
                                                                    </mat-toolbar>                                 
                                                                </td>
                                                                
                                                    </tr>
                                                </ng-template>
                                            </p-table>
                                        </div>
                                        <app-shop-list-map [shopList]="shopList" *ngIf="viewType == 'MAP'"></app-shop-list-map>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>